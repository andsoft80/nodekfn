<!DOCTYPE html>
<html ng-app="myApp">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="Cache-Control" content="no-cache" />
        <meta http-equiv="Pragma" content="no-cache" />

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script type="text/javascript" src="https://cdn.rawgit.com/ricmoo/aes-js/e27b99df/index.js"></script>

        <script src="sidebar.min.js" type="text/javascript"></script>
        <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400" rel="stylesheet" />
        <link rel="stylesheet" href="lib/fontello.css" />
        <!--<link rel="stylesheet" href="http://68.183.69.229:3000/lib/normalize.css" />-->
        <link href="sidebar.css" rel="stylesheet" type="text/css"/>
        <link href="index.css" rel="stylesheet" type="text/css"/>        
        <!--<link href="sidebar-0.2.0/css/index.css" rel="stylesheet" type="text/css"/>-->
        <!--<script src="//ajax.aspnetcdn.com/ajax/jquery.ui/1.10.3/jquery-ui.min.js"></script>-->
        <script src="jquery-ui.js" type="text/javascript"></script>
        <link rel="stylesheet" href="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.10.3/themes/start/jquery-ui.css">

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        <link href="https://fonts.googleapis.com/css?family=Roboto:100" rel="stylesheet">

        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/jstree/3.3.5/themes/default/style.min.css" />
        <script src="//cdnjs.cloudflare.com/ajax/libs/jstree/3.3.5/jstree.min.js"></script> 
        <link href="lib/noty.css" rel="stylesheet">
        <link href="lib/themes/light.css" rel="stylesheet">
        <link href="lib/themes/relax.css" rel="stylesheet">
        <script src="lib/noty.js" type="text/javascript"></script>
        <script src="prepob.js" type="text/javascript"></script>

        <title>Караоке плеер</title>
        <script>
            ////////////////////////////////////////////

            var host = 'http://185.220.35.146:80/';





            var app = angular.module('myApp', []);
            app.controller('myCtrl', function ($scope) {
                $scope.playList = [];
                $scope.filter = '';




                $scope.reBuildSeq = function (listjson) {

                    for (var i = 0; i < listjson.length; i++) {

                        listjson[i].id = i + 1;
                    }
                    return listjson;
                }

                $scope.list = function () {

                    var pl = localStorage.getItem('playList');

                    return(pl);

                }
                ;

                $scope.list_add = function (filename, artist) {
                    var listjson = [];
                    var id = 1;
                    var pl = localStorage.getItem('playList');
                    if (pl !== null) {

                        listjson = JSON.parse(pl);
                        if (listjson.length > 0) {
                            id = listjson[listjson.length - 1].id + 1;
                        }
                    }



                    var entry = {
                        "id": "",
                        "name": "",
                        "artist": ""

                    };
                    for (var i = 0; i < listjson.length; i++) {
                        if (listjson[i].name === filename) {

                            return JSON.stringify(listjson);
                            ;
                        }
                    }

                    entry.id = id;
                    entry.name = filename;
                    entry.artist = artist;
                    listjson.push(entry);

                    localStorage.setItem('playList', JSON.stringify(listjson));

                    $scope.playList = listjson;
                    return JSON.stringify(listjson);


                }
                ;

                $scope.list_delete = function (id) {
                    var listjson = '';

                    var pl = localStorage.getItem('playList');
                    listjson = JSON.parse(pl);
                    var i = 0;
                    var find = -1;

                    for (var i = 0; i < listjson.length; i++) {

                        if (listjson[i].id.toString() === id.toString()) {

                            find = i;
                            break;
                        }
                        ;
                    }
                    ;

                    if (find > -1) {
                        listjson.splice(find, 1);
                        listjson = $scope.reBuildSeq(listjson);

                    }


                    localStorage.setItem('playList', JSON.stringify(listjson));


                    $scope.playList = listjson;



                }
                ;

                $scope.list_up = function (id) {
                    var listjson = '';
                    var pl = localStorage.getItem('playList');

                    listjson = JSON.parse(pl);
                    var i = 0;
                    var find = -1;

                    for (var i = 0; i < listjson.length; i++) {

                        if (listjson[i].id.toString() === id.toString()) {

                            find = i;
                            break;
                        }
                        ;
                    }
                    ;

                    if (find > 0) {
                        var tmp = listjson[find];
                        listjson[find] = listjson[find - 1];
                        listjson[find - 1] = tmp;
                        listjson = $scope.reBuildSeq(listjson);

                    }


                    localStorage.setItem('playList', JSON.stringify(listjson));

                    $scope.playList = listjson;




                }
                ;

                $scope.list_down = function (id) {
                    var listjson = '';
                    var pl = localStorage.getItem('playList');

                    listjson = JSON.parse(pl);
                    var i = 0;
                    var find = -1;

                    for (var i = 0; i < listjson.length; i++) {

                        if (listjson[i].id.toString() === id.toString()) {

                            find = i;
                            break;
                        }
                        ;
                    }
                    ;

                    if (find < listjson.length - 1) {
                        var tmp = listjson[find];
                        listjson[find] = listjson[find + 1];
                        listjson[find + 1] = tmp;
                        listjson = $scope.reBuildSeq(listjson);

                    }


                    localStorage.setItem('playList', JSON.stringify(listjson));


                    $scope.playList = listjson;


                }
                ;

                $scope.sidebarTrigger = function () {

                    if (($('.jsc-sidebar-pushed').length !== 0)) {
                        $('#jsi-nav').data('sidebar').pull();
                    } else {
                        $('#jsi-nav').data('sidebar').push();
                    }


                }
                $scope.getPlayList = function () {

//                    $.ajax({
//                        type: "GET",
//                        async: false,
//                        url: "http://192.168.0.28:8080/list",
//                        success: function (data) {
//                            $scope.playList = JSON.parse(data);
//                            $scope.$apply();
//                        }
//                    });
                    $scope.playList = JSON.parse($scope.list());
                    //$scope.$apply();




                };
                $scope.hint = function (txt) {

                }
                $scope.play = function (fileName, artist) {
                    noty = new Noty({
                        type: 'info',
                        theme: 'relax',
                        layout: 'topRight',
                        text: 'Песня загружается...',
                        callbacks: {
                            afterShow: function () {
                                slash = '%5C';
                                if (!artist) {
                                    fn = 'downloads';
                                } else {
                                    fn = 'downloads' + slash + artist;
                                }

                                fn = fn + slash + fileName;
                                $('#jsi-nav').data('sidebar').pull();
                                $().JqueryFunction(fn);
                                noty.close();
                            },
                        }
                    }).show();



                };
//                $("form#transferForm").submit(function () {
//
//                    var formData = new FormData($(this)[0]);
//                    $.ajax({
//                        url: '/transfer',
//                        type: 'POST',
//                        data: formData,
//                        async: false,
//                        success: function (data) {
//                            var entry = {
//                                "id": "",
//                                "name": ""
//
//                            };
//                            entry.id = $scope.playList.length + 1;
//                            entry.name = data;
//                            $scope.playList.push(entry);
//                            $scope.$apply();
//                        },
//                        cache: false,
//                        contentType: false,
//                        processData: false
//                    });
//                    return false;
//                });
                $scope.addSong = function () {

//                    $("#selectSong").css({display: 'block'});
                    $.ajax({
                        type: "GET",
                        async: false,
                        url: host+"listinit",
                        success: function (data) {
//                           alert(data);

                            trees = $('#tree').jstree({

                                "checkbox": {
                                    //"keep_selected_style": false
                                },
                                "themes": {"stripes": true},
                                'core': {
                                    'data': JSON.parse(data)
                                },
                                "plugins": [
                                    "wholerow", "checkbox"
                                ]

                            });

//                            tree.defaults.core.data = JSON.parse(data);


                            trees.close_all();
                            trees.uncheck_all();




                        }
                    });
                    $("#dialog").dialog({
                        width: 500,
                        position: 'top',
                        dialogClass: "alert",
                        title: "КАТАЛОГ",
                        buttons: [
                            {
                                text: "OK",
                                click: function () {
                                    selarr = $('#tree').jstree().get_selected(true);
                                    //alert(JSON.stringify(selarr));
                                    for (var i = 0; i < selarr.length; i++) {
                                        selnode = selarr[i];
                                        if (selnode.parent === '#') {
                                            continue;
                                        }
                                        txt = selnode.text;
                                        parentTxt = $('#tree').jstree().get_node(selnode.parent).text;
//                                        parcel = {"filename": txt, "artist": parentTxt};
//                                        $.ajax({
//                                            type: "post",
//                                            async: false,
//                                            data: parcel,
//                                            url: "http://192.168.0.28:8080/list_add",
//                                            success: function (data) {
//                                                $scope.playList = JSON.parse(data);
//                                                $scope.$apply();
//                                            }
//                                        });
                                        $scope.playList = JSON.parse($scope.list_add(txt, parentTxt));
                                        $scope.$apply();
                                    }
                                    $(this).dialog("close");
                                }
                            }
                        ]
                    });








                };
//                $scope.closeSelectSong = function () {
//
//                    $("#selectSong").css({display: 'none'});
//
//
//                };





            });
            ////////////////////////////////////////////



//
//            var reader = null;
//            var a = null;
//            var b = null;
//            var input = null;
//            var key = null;
//            var entryArr = [];
//            var tarr = [];
//            var marr = [];
            var currPlayData = null;
            function getFileBinary(filename) {
                var res = null;
                $.ajax({
                    type: "GET",
                    async: false,
                    url: host+"getfilebin/" + filename,
                    success: function (data) {
                        res = data;
                    }
                });
                return res;
            }

            function getFileHex(filename) {
                var res = null;
                $.ajax({
                    type: "GET",
                    async: false,
                    url: host+"getfilehex/" + filename,
                    success: function (data) {
                        res = data;
                    }
                });
                return res;
            }

            (function ($) {
                $.fn.JqueryFunction = function (playFileName) {
                    addFiles(playFileName)
                };
            })(jQuery);
            function addFiles(playFileName) {

                function filePlay(playFileName) {

//                    $.ajax({
//                        type: "GET",
//                        async: false,
//                        url: "http://192.168.0.28:8080/prep/" + playFileName,
////                        dataType: "JSON",
////                        contentType: "JSON",
//                        success: function (data) {
//                            //res = data;
//                            res = JSON.parse(data);
//                            
//                            parcel = (res);
//                            if (parcel.error === 'format') {
//                                alert('Не верныйформат файла!');
//                                return;
//                            } else {
//                                Artist = parcel.artist;
//                                Title = parcel.title;
//                                lineArrJson = (parcel.linearrjson);
//                                entryArr = parcel.entryarr;
//                            }
//                        }
//                    });
//                        mp3 = b.substring(entryArr[0].offset, entryArr[0].length1);
//                        var audio = document.createElement('audio');
//                        audio.src = 'data:audio/mpeg;base64,' + btoa(mp3);
//                        audio.play();
//
//                        jpeg = b.substring(entryArr[1].offset, entryArr[1].length1);
//                        var img = document.createElement('img');
//                        t = (readbytes(entryArr[1].offset, a, entryArr[1].length1));
//                        img.src = 'data:image/jpeg;base64,' + hexToBase64(t.join(""));
//                        document.body.appendChild(img);

                    /////Вывод плеера////////////////////////
                    //isBG = true;


                    //bg////////////////////////

                    if (!prepFile(playFileName)) {
                        alert('Не верныйформат файла!');
                        return;
                    }
                    var txt = document.getElementById('text');
                    txt.innerHTML = Title + '<br>' + Artist;
                    var width = Math.round($('#text').parent().width() / 2) - Math.round($('#text').width() / 2);
                    var height = Math.round($('#text').parent().height() / 2) - Math.round($('#text').height() / 2);
                    $('#text').css({top: height, left: width, position: 'absolute'});
                    ////////////////////////////

                    for (var i = 0; i < entryArr.length; i++) {
                        entry = entryArr[i];
                        type = entry.type;
                        //if (type === 5) {


//                                var video = document.createElement('video');
//                                video.src = 'data:video/avi;base64,' + btoa(entry.bindata);
//                                video.controls = 'controls';
//                                document.body.appendChild(video);
//                                video.load();
//                                
//                                video.play();
//                                isBG = false;



                        //}
//
//                            if (type === 3 & isBG) {
//
//                                var img = document.createElement('img');
//                                img.src = 'data:image/jpeg;base64,' + btoa(entry.bindata);
//                                document.body.appendChild(img);
//                                isBG = false;
//
//                            }


                        if (type === 2) {


                            var audio = document.getElementById('mp3');
                            if (!audio) {
                                audio = document.createElement('audio');
                                audio.setAttribute("id", "mp3");
                            }
                            //currPlayData = 'data:audio/mpeg;base64,' + btoa(entry.bindata);
                            audio.src = 'data:audio/mpeg;base64,' + btoa(entry.bindata);
                            console.log('play');
                            $('#text').css({top: height, left: width, position: 'absolute'});
                            audio.setAttribute('controls', 'controls');
                            audio.setAttribute('preload', 'auto');
                            duration = audio.duration;
                            document.getElementById('workplace').appendChild(audio);
                            var width = ($('#text').parent().width() / 2) - ($('#text').width() / 2);
                            var height = ($('#text').parent().height() / 2) - ($('#text').height() / 2);
                            $('#text').css({top: height, left: width, position: 'absolute'});
                            audio.addEventListener("play", function () {

                            });
                            function buildText(timeSec) {

                                var time1 = null;
                                var time2 = null;
                                var findLinePos = null;
                                var findSplitPos = null;
                                if (timeSec < parseInt(lineArrJson[0].timeSplit[0])) {//до первого тайминга
                                    findLinePos = null;
                                    findSplitPos = null;
                                    txt.innerHTML = lineArrJson[0].lineText + '</br>' + lineArrJson[1].lineText;
                                    var width = ($('#text').parent().width() / 2) - ($('#text').width() / 2);
                                    var height = ($('#text').parent().height() / 2) - ($('#text').height() / 2);
                                    $('#text').css({top: height, left: width, position: 'absolute'});
                                    time1 = 0;
                                    time2 = lineArrJson[0].timeSplit[0];


                                }
                                if (timeSec > parseInt(lineArrJson[lineArrJson.length - 1].timeSplit[lineArrJson[lineArrJson.length - 1].timeSplit.length - 1])) {//после последнего тайминга
                                    findLinePos = null;
                                    findSplitPos = null;
//                                    txt.innerHTML = lineArrJson[0].lineText + '</br>' + lineArrJson[1].lineText;
//                                    var width = ($('#text').parent().width() / 2) - ($('#text').width() / 2);
//                                    var height = ($('#text').parent().height() / 2) - ($('#text').height() / 2);
//                                    $('#text').css({top: height, left: width, position: 'absolute'});
                                    time1 = parseInt(lineArrJson[lineArrJson.length - 1].timeSplit[lineArrJson[lineArrJson.length - 1].timeSplit.length - 1]);
                                    time2 = parseInt(lineArrJson[lineArrJson.length - 1].timeSplit[lineArrJson[lineArrJson.length - 1].timeSplit.length - 1]);
                                    findLinePos = lineArrJson.length - 1;
                                    findSplitPos = lineArrJson[lineArrJson.length - 1].timeSplit.length - 1;

                                }
                                for (var k = 0; k < lineArrJson.length & time1 === null; k++) {
                                    var i = 0;
                                    while (i < lineArrJson[k].timeSplit.length) {


                                        nextSplitTime = lineArrJson[k].timeSplit[i];//тот же тайминг
                                        if (i !== lineArrJson[k].timeSplit.length - 1) {
                                            nextSplitTime = lineArrJson[k].timeSplit[i + 1];//следующий тайминг в тойже строке
                                        } else if (k !== lineArrJson.length - 1) {
                                            nextSplitTime = lineArrJson[k + 1].timeSplit[0];//следующий тайминг в следующей строке
                                        }
                                        time2 = nextSplitTime;
                                        if ((timeSec >= parseInt(lineArrJson[k].timeSplit[i])) & (timeSec <= parseInt(nextSplitTime))) {
                                            findLinePos = k;
                                            findSplitPos = i;
                                            time1 = lineArrJson[findLinePos].timeSplit[findSplitPos];
                                            break;
                                        }



                                        i++;
                                    }


                                }



                                //проигрыш от 5 сек////////////////////////////////
                                if (time2 - time1 >= 500) {
                                    console.log(time1 + ' ' + time2);
                                    //$('#progressb').show();
                                    var width = ($('#progressb').parent().width() / 2) - ($('#progressb').width() / 2);
                                    var height = ($('#progressb').parent().height() / 1.40) - ($('#progressb').height());
                                    $('#progressb').css({top: height, left: width, zIndex: 299});
                                    var delta = null;
//                                    var progress = (timeSec - time1) / (time2 - time1) * 100 + "%";
                                    progress = (timeSec - time1) / (time2 - time1) * 100;
                                    delta = Math.round((time2 - timeSec) / 100);
                                    //console.log(delta);

                                    if (delta < 3) {
                                        delta++;
                                        $('#countdown').html('<font size ="30px" color = "white"><strong>' + delta + '</strong></font>');
                                        $('#countdown').css({zIndex: 300});
                                    } else {
                                        $('#countdown').css({zIndex: -1});
                                    }


//                                    $('#progressfill').css({width: progress});
                                    $('#progressb').progressbar({
                                        value: progress
                                    });
                                } else {
                                    $('#progressb').css({zIndex: -1});
                                    $('#countdown').css({zIndex: -1});
                                    $('#progressfill').css({width: '0%'});
                                    // $('#progressb').hide();

                                }
                                ;
                                //////////////////////////////////////////////////                                



                                drawText(findLinePos, findSplitPos, timeSec);
                            }

                            function drawText(findLinePos, findSplitPos, timeSec) {
                                var redPart = '';
                                var whitePart = '';
                                cTxt = $('#text').text();
                                if (findLinePos !== null) {
                                    //if (findSplitPos > 0) {//есть красное
                                    redPart = lineArrJson[findLinePos].wordSplit.slice(0, findSplitPos + 1).join('');
                                    whitePart = lineArrJson[findLinePos].wordSplit.slice(findSplitPos + 1, lineArrJson[findLinePos].wordSplit.length).join('');
                                    if (findLinePos % 2 === 0 & findLinePos < lineArrJson.length - 1) {//первая

                                        txt.innerHTML = '<font  color="red">' + redPart + '</font>' + whitePart + '</br>' + lineArrJson[findLinePos + 1].lineText;
                                    } else if (findLinePos % 2 === 1) {//вторая
                                        txt.innerHTML = '<font  color="red">' + lineArrJson[findLinePos - 1].lineText + '</br>' + redPart + '</font>' + whitePart;
                                        if ((findSplitPos === lineArrJson[findLinePos].wordSplit.length - 1)) {
                                            if (timeSec > (parseInt(lineArrJson[findLinePos].timeSplit[findSplitPos]) + 50)) {



                                                nextWhite1 = '';
                                                nextWhite2 = '';
                                                if (findLinePos + 1 <= lineArrJson.length - 1) {
                                                    nextWhite1 = lineArrJson[findLinePos + 1].lineText;
                                                }
                                                if (findLinePos + 2 <= lineArrJson.length - 1) {
                                                    nextWhite2 = lineArrJson[findLinePos + 2].lineText;
                                                }
                                                if (nextWhite1 !== '') {
                                                    txt.innerHTML = nextWhite1 + '</br>' + nextWhite2;
                                                }
                                            }
                                        }
                                    } else if (findLinePos % 2 === 0 & findLinePos === lineArrJson.length - 1) {//первая, но последняя
                                        txt.innerHTML = '<font  color="red">' + redPart + '</font>' + whitePart;
                                    }

                                }
                                if (cTxt.replace(/\s/g, "") !== $('#text').text().replace(/\s/g, "")) {
                                    var width = ($('#text').parent().width() / 2) - ($('#text').width() / 2);
                                    var height = ($('#text').parent().height() / 2) - ($('#text').height() / 2);
                                    $('#text').css({top: height, left: width, position: 'absolute'});
                                }
                            }


                            audio.addEventListener("timeupdate", function () {
                                ct = audio.currentTime * 100; //by 100 ms

                                buildText(ct);
                            });
                            ci = 0;
                            audio.play();
                            var width = ($('#mp3').parent().width() / 2) - ($('#mp3').width() / 2);
                            var height = ($('#mp3').parent().height() / 1.15) - ($('#mp3').height());
                            $('#mp3').css({top: height, left: width, position: 'absolute'});
                            $('#countdown').html('<font size ="30px" color = "white"><strong>' + 3 + '</strong></font>');
                            var width = ($('#countdown').parent().width() / 2) - ($('#countdown').width() / 2);
                            var height = ($('#countdown').parent().height() / 1.40) - ($('#countdown').height());
                            $('#countdown').css({top: height, left: width});
                            return;
                        }

                    }
                    //};





                    ////////////////////////////////////////////


                }
                ;
                filePlay(playFileName);
                //reader.readAsArrayBuffer(input.files[0]); 



            }////конец главной функции      
            ;
            function load() {
                //$('#progressb').hide();
                var img = document.getElementById('image');
                var n = Math.floor(Math.random() * (10) + 1) / 1;
                var bindata = getFileBinary('images%5C' + n + '.jpg');
                img.src = 'data:image/jpeg;base64,' + btoa(bindata);
//                var vid = document.getElementById('video');
//                var bindata = getFileBinary('images%5C1.webm');
//                vid.src = 'data:video/webm;base64,' + btoa(bindata);
//                //vid.type = 'video/webm';
//                vid.load();
//                vid.play();
//                var elem = document.getElementById("video");
//                if (elem.requestFullscreen) {
//                    elem.requestFullscreen();
//                } else if (elem.msRequestFullscreen) {
//                    elem.msRequestFullscreen();
//                } else if (elem.mozRequestFullScreen) {
//                    elem.mozRequestFullScreen();
//                } else if (elem.webkitRequestFullscreen) {
//                    elem.webkitRequestFullscreen();
//                }

                window.addEventListener('resize', () => {
                    var width = ($('#mp3').parent().width() / 2) - ($('#mp3').width() / 2);
                    var height = ($('#mp3').parent().height() / 1.15) - ($('#mp3').height());
                    $('#mp3').css({top: height, left: width, position: 'absolute'});

                    var width = ($('#countdown').parent().width() / 2) - ($('#countdown').width() / 2);
                    var height = ($('#countdown').parent().height() / 1.40) - ($('#countdown').height());
                    $('#countdown').css({top: height, left: width});

                    var width = ($('#text').parent().width() / 2) - ($('#text').width() / 2);
                    var height = ($('#text').parent().height() / 2) - ($('#text').height() / 2);
                    $('#text').css({top: height, left: width, position: 'absolute'});
                });

                $(function () {

                });

            }



        </script>
        <style>

            body {
                overflow: hidden;

            }
            #container {

                width: 100vw;
                height: 100vh;

            }
            #image {

                position: absolute;
                left: 0;
                top: 0;
                height: 100%;
                width: 100%;  
                /*z-index: 50;*/
            }
            #video {

                /*position: absolute;*/
                /*                left: 0;
                                top: 0;*/
                width: auto;
                height: auto;           
            }

            #text {
                z-index: 100;
                color: white;

                font-weight: bold;
                position: absolute;
                font-size: 60px;
                text-shadow: 1px 1px 1px #000;



            }
            #mp3 {
                z-index: 100;
                position: absolute;
                /*                left: 0;
                                margin: 0;*/
                /*text-align: center;*/


            }
            #form1 {
                z-index: 100;
                position: absolute;
                left: 400px;
            }
            #progressb {
                z-index:-1;
                position: absolute;
                left: 50vw;
                top: 75vh;
                width: 250px;
                text-align: center;
                height: 20px;
                opacity: 0.6;

                /*display: none;*/
            }
            /*            #progressfill {
                            font-weight:bold;
            
                        }*/
            #countdown {
                z-index:-1;
                position: absolute;
            }
            .ui-progressbar-value {
                background-image: url(http://www.professorweb.ru/downloads/jquery/progress-animation.gif);
            }
            .ui-progressbar {
                height: 22px;
            }




            form {

                position: relative;
                width: 320px;
                margin: 10px;

            }
            .d1 {background: #464646;}
            .d1 input {

                width: 100%;
                height: 30px;
                padding-left: 10px;
                border: 2px solid #7BA7AB;
                border-radius: 5px;
                outline: none;
                background: #F9F0DA;
                color: #9E9C9C;
                font-family: "Roboto", sans-serif;
            }
            .d1 button {

                position: absolute; 
                top: 0;
                right: 0px;
                width: 30px;
                height: 30px;
                border: none;
                background: #7BA7AB;
                border-radius: 0 5px 5px 0;
                cursor: pointer;
            }
            .d1 button:before {

                content: "\f002";
                font-family: FontAwesome;
                font-size: 16px;
                color: #F9F0DA;
            }

            table {
                width: 320px;
                margin: 10px;
                font: 14px Arial;
                text-align: left;
                border-collapse: collapse;
                border: 2px solid #7BA7AB;

            }

            table th {
                background: #7BA7AB;
                color: white;
                font-family: "Roboto", sans-serif;
            }

            table th,
            table td {
                padding: 5px;
                font-family: "Roboto", sans-serif;
            }

            table tbody tr:nth-child(odd){
                background: #fff;
            }

            table tbody tr:nth-child(even){ 
                background: #f2f6f8;
            }
            a{
                color: #464646;
                text-decoration: none;
                /*                background: silver;
                                padding: 5px;*/
                /*margin: 10px;*/
            }

            #closeBtn {

                position: relative;
                padding: 10px;
                float: right;


            }
            #head {

                position: relative;
                padding: 10px;
                float: left;


            }
            #dialog {

            }     
            #wait {

                position: absolute;
                left: 300px;
                top: 300px;

                z-index: 50;
            }

        </style>

    </head>
    <body onload = 'load()'  ng-controller="myCtrl" ng-init="getPlayList()">

        <!--        <div id ='form1'>
                    <input type="button" value="Играть" onclick="addFiles('downloads%5Ckrug.kfn')">        
                </div>-->
        <div id="container">

            <div id = 'workplace' class="wrapper jsc-sidebar-content jsc-sidebar-pulled">
                <img id="image"/>

                <nav >
                    <!--                    <a href="#" class="icon-menu link-menu jsc-sidebar-trigger">ПЛЕЙЛИСТ</a>-->
                    <a href="" class="icon-menu link-menu " ng-click="sidebarTrigger()">ПЛЕЙЛИСТ</a>

                </nav>
                <!--<div id="wait"><img src="http://68.183.69.229:3000/wait.gif"></div>-->
                <p id="text">                
                </p>
                <!--<audio id='mp3'></audio>-->
                <div  id = 'progressb' >
                    <!--<div id = 'progressfill' class="progress-bar progress-bar-striped  progress-bar-animated" role="progressbar" style="width: 0%; " aria-valuenow="14" aria-valuemin="0" aria-valuemax="100"></div>-->
                </div>
                <div id = 'countdown'></div>

            </div>            

            <nav class="sidebar jsc-sidebar" id="jsi-nav" data-sidebar-options="">

                <form class="d1">
                    <input ng-model="filter" type="search" placeholder="Искать песню...">
                    <!--<button type="submit"></button>-->
                </form>



                <a href='' style='font-family: "Roboto", sans-serif; margin: 10px; color : white;' ng-click="addSong();"><i class="fa fa-plus" aria-hidden="true" ></i> ДОБАВИТЬ ПЕСНЮ</a>

                <form id = 'transferForm' enctype="multipart/form-data" method="post">
                    <p><input id = 'selectFile' type="file" name="f" accept=".kfn" onchange = '$("#sendFile").click();' hidden>
                        <input id = 'sendFile' type="submit" value="Отправить" hidden></p>
                </form>                 

                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Название песни</th>
                            <th>Артист</th>
                            <th width = 30px>Управление</th>

                        </tr>
                    </thead>
                    <tbody >
                        <tr ng-repeat="song in playList| filter:{name:filter}">
                            <td>{{song.id}}</td>
                            <td>{{song.name}}</td>
                            <td>{{song.artist}}</td>
                            <td>  
                                <a href='#'><i class="fa fa-arrow-up" aria-hidden="true" title='Поднять вверх' ng-click="list_up(song.id)"></i></a>
                                <a href='#'><i class="fa fa-arrow-down" aria-hidden="true" title='Опустить вниз' ng-click="list_down(song.id)"></i></a>
                                <a href='#'><i class="fa fa-trash" aria-hidden="true" title='Удалить из списка' ng-click="list_delete(song.id)"></i></a>
                                <a href='#'><i class="fa fa-play" aria-hidden="true" title='Начать петь' ng-click="play(song.name, song.artist)"></i></a>
                            </td>

                        </tr>

                    </tbody>
                </table>
            </nav>
            <div id='dialog'>
                <div id = 'selectSong' >

                    <div id = 'tree'></div>
                </div>

            </div>


            <!--            <img id="image"/>-->
            <!--<video id='video' muted="muted" loop fullscreen></video>-->
            <!--            <p id="text">                
                        </p>
                        <audio id='mp3'></audio>
                        <div  id = 'progressb' >
                            <div id = 'progressfill' class="progress-bar progress-bar-striped  progress-bar-animated" role="progressbar" style="width: 0%; " aria-valuenow="14" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <div id = 'countdown'></div>-->

        </div>




        <script>
                    $('#jsi-nav').sidebar({
                        trigger: '.jsc-sidebar-trigger',
                        scrollbarDisplay: true,
                        pullCb: function () {

                        },
                        pushCb: function () {

                        }
                    });

                    $('#api-push').on('click', function (e) {
//                        e.preventDefault();
//                        $('#jsi-nav').data('sidebar').push();
                    });
                    $('#api-pull').on('click', function (e) {
//                        e.preventDefault();
//                        $('#jsi-nav').data('sidebar').pull();
                    });
        </script>


        <!--<script type="text/javascript" src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>-->
        <!--<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">-->
    </body>
</html>

















